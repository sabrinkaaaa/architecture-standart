@startuml
!define RECTANGLE component

actor Клиент as Client
actor ОператорКолЦентра as OperatorCC
actor ОператорПартнёрскогоКолЦентра as OperatorPartnerCC

rectangle "Сайт банка\n(PHP + React.js)" as Website {
  component "Веб-приложение\nReact.js" as WebsiteFrontend
  component "Бэкенд\nPHP, MS SQL" as WebsiteBackend
}

rectangle "Интернет-банк\n(.NET MVC + MS SQL)" as InternetBank {
  component "Веб-приложение\nASP.NET MVC" as IBFrontend
  component "Бизнес-логика\n.NET" as IBBusinessLogic
  component "База данных\nMS SQL" as IBDatabase
}

rectangle "Система кол-центра банка\n(React.js + Java Spring Boot + PostgreSQL)" as CallCenter {
  component "Веб-интерфейс оператора\nReact.js" as CCFrontend
  component "Бэкенд\nJava Spring Boot" as CCBackend
  component "База данных\nPostgreSQL" as CCDatabase
}

rectangle "Система партнёрского кол-центра\n(Внешняя система)" as PartnerCallCenter {
  component "Веб-интерфейс оператора\nВнешний" as PartnerCCFrontend
  component "Сервер обработки ставок\nВнешний" as PartnerCCServer
}

rectangle "Автоматизированная банковская система (АБС)\n(Delphi + Oracle)" as ABS {
  component "Десктопный клиент\nDelphi" as ABSClient
  component "Бизнес-логика и данные\nPL-SQL + Oracle" as ABSDatabase
}

rectangle "СМС-шлюз оператора\n(Внешняя система)" as SMSGateway

rectangle "Хранилище ставок депозитов" as RatesStorage {
  component "База ставок\nMS SQL/Oracle" as RatesDB
}

rectangle "Файловый обмен ставками\n(CSV/XLS)" as RatesFileExchange

' Клиенты
Client --> WebsiteFrontend : Просмотр депозитов\nПодача заявки (ФИО, тел.)
WebsiteFrontend --> WebsiteBackend : Запрос/передача заявки (HTTPS)
Client --> IBFrontend : Просмотр депозитов\nПодача заявки

' Сайт -> Кол-центр
WebsiteBackend --> CCBackend : Передача заявки (шифр., REST/Очередь)
IBFrontend --> IBBusinessLogic : Обработка заявки
IBBusinessLogic --> CCBackend : Отправка заявки для обработки

' СМС
IBBusinessLogic --> SMSGateway : Отправка СМС-кода
ABSDatabase --> SMSGateway : Отправка уведомлений клиенту

' Кол-центр банка
CCFrontend --> CCBackend : Действия оператора
CCBackend --> CCDatabase : Сохранение заявки
CCBackend --> ABSDatabase : Подтверждение условий и открытие депозита

' Операторы
OperatorCC --> CCFrontend : Консультация по ставкам
OperatorPartnerCC --> PartnerCCFrontend : Консультация по ставкам

' Ставки
ABSDatabase --> RatesDB : Экспорт актуальных ставок
RatesDB --> WebsiteBackend : Загрузка ставок
RatesDB --> IBBusinessLogic : Загрузка ставок
RatesDB --> CCBackend : Доступ к ставкам
RatesDB --> RatesFileExchange : Экспорт ставок в файл
RatesFileExchange --> PartnerCCServer : Передача файла

@enduml
